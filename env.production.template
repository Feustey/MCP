# =================================
# MCP PRODUCTION CONFIGURATION
# =================================
# Dernière mise à jour: 15 octobre 2025
#
# ⚠️  IMPORTANT : Copier ce fichier en .env.production après configuration
# ⚠️  NE JAMAIS commiter .env.production avec des credentials réels
#
# Commande: cp env.production.template .env.production

# =================================
# MODE OPÉRATION
# =================================
ENVIRONMENT=production
DRY_RUN=true  # ⚠️ Commencer en Shadow Mode ! Passer à 'false' après validation
DEBUG=false

# =================================
# LNBits / LND CONNECTION
# =================================
LNBITS_URL=https://your-production-lnbits-instance.com
LNBITS_API_KEY=your_lnbits_api_key_here
LNBITS_ADMIN_KEY=your_lnbits_admin_key_here
LNBITS_INVOICE_KEY=your_lnbits_invoice_key_here

# LND Direct (optionnel si pas LNBits)
LND_REST_URL=https://your-lnd-node:8080
LND_MACAROON_PATH=/path/to/admin.macaroon
LND_TLS_CERT_PATH=/path/to/tls.cert

# =================================
# SECURITY
# =================================
# Génération clé chiffrement :
# python3 -c "from cryptography.fernet import Fernet; print(Fernet.generate_key().decode())"
MACAROON_ENCRYPTION_KEY=CHANGE_ME_GENERATE_WITH_FERNET
MACAROON_ROTATION_DAYS=30

# API Authentication (à implémenter)
API_SECRET_KEY=CHANGE_ME_GENERATE_RANDOM_64_CHARS
JWT_SECRET_KEY=CHANGE_ME_GENERATE_RANDOM_64_CHARS

# =================================
# MONGODB ATLAS (Production Database)
# =================================
MONGODB_URI=mongodb+srv://username:password@cluster.mongodb.net/mcp_prod?retryWrites=true&w=majority
MONGODB_DATABASE=mcp_prod
MONGODB_CONNECTION_POOL_SIZE=50
MONGODB_TIMEOUT_MS=5000

# =================================
# REDIS CLOUD / UPSTASH (Cache)
# =================================
REDIS_URL=redis://default:password@your-redis-instance:port
REDIS_PASSWORD=your_redis_password
REDIS_TLS=true
REDIS_MAX_CONNECTIONS=10

# =================================
# QDRANT (Vector Database for RAG)
# =================================
QDRANT_URL=http://localhost:6333
QDRANT_API_KEY=  # Optionnel si cloud
QDRANT_COLLECTION_NAME=lightning_docs

# =================================
# AI / LLM
# =================================
ANTHROPIC_API_KEY=your_anthropic_api_key_here
OPENAI_API_KEY=your_openai_api_key_here  # Optionnel
OLLAMA_URL=http://ollama:11434
GEN_MODEL=llama3:70b-instruct-2025-07-01
EMBED_MODEL=nomic-embed-text
EMBED_VERSION=2025-10-15
RAG_TOPK=8

# =================================
# NOTIFICATIONS
# =================================
TELEGRAM_BOT_TOKEN=your_telegram_bot_token
TELEGRAM_CHAT_ID=your_telegram_chat_id

# Email (optionnel)
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=your_email@gmail.com
SMTP_PASSWORD=your_app_password
ALERT_EMAIL=alerts@yourdomain.com

# =================================
# MONITORING
# =================================
# Prometheus
PROMETHEUS_ENABLED=true
PROMETHEUS_PORT=9090

# Grafana
GRAFANA_URL=http://localhost:3000
GRAFANA_API_KEY=your_grafana_api_key

# =================================
# SAFETY LIMITS (Decision Thresholds)
# =================================
MAX_BASE_FEE_MSAT=10000
MAX_FEE_RATE_PPM=5000
MIN_BASE_FEE_MSAT=0
MIN_FEE_RATE_PPM=1

# Changements (protection)
MAX_FEE_CHANGE_PERCENT=50  # Max ±50% par changement
COOLDOWN_MINUTES=60  # Minimum entre 2 changements sur même canal

# Canaux critiques (séparés par virgule)
BLACKLISTED_CHANNELS=123456x789x0,234567x890x1

# =================================
# RATE LIMITING
# =================================
RATE_LIMIT_LNBITS=100  # Requêtes par minute
RATE_LIMIT_API=1000  # Requêtes API REST par minute

# =================================
# LOGS
# =================================
LOG_LEVEL=INFO  # DEBUG, INFO, WARNING, ERROR
LOG_FORMAT=json  # json ou text
LOG_FILE=/var/log/mcp/mcp.log
LOG_ROTATION=daily
LOG_RETENTION_DAYS=30

# =================================
# API SERVER
# =================================
API_HOST=0.0.0.0
API_PORT=8000
API_WORKERS=4
API_RELOAD=false  # true seulement en dev

# CORS
CORS_ORIGINS=https://yourdomain.com,https://app.yourdomain.com
CORS_ALLOW_CREDENTIALS=true

# =================================
# BACKGROUND TASKS
# =================================
ENABLE_SCHEDULER=true
SYNC_INTERVAL_MINUTES=60  # Sync graphe réseau toutes les heures
OPTIMIZE_INTERVAL_MINUTES=120  # Optimisation toutes les 2h

# =================================
# INTÉGRATIONS EXTERNES
# =================================
# Amboss
AMBOSS_API_KEY=your_amboss_api_key

# 1ML
ONE_ML_API_KEY=your_1ml_api_key

# Mempool
MEMPOOL_API_URL=https://mempool.space/api

# =================================
# BACKUP
# =================================
BACKUP_ENABLED=true
BACKUP_INTERVAL_HOURS=24
BACKUP_RETENTION_DAYS=90
BACKUP_PATH=/var/backups/mcp

# =================================
# PERFORMANCE
# =================================
CACHE_TTL_SECONDS=300  # 5 minutes
MAX_CONCURRENT_OPTIMIZATIONS=5
BATCH_SIZE=100

